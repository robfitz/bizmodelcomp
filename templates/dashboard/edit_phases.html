{% extends 'base.html' %}

{% block meta %}
<link rel="stylesheet" type="text/css" href="/media/competition/style/dashboard.css" />
{% endblock %}

{% block header_title %}
View & edit phases
{% endblock %}

{% block script %}

	var open_phase;

	function edit_phase(phase_num) {

		cancel_edit();

		open_phase = phase_num;

		$('#view_phase_' + phase_num).slideUp();
		$('#edit_phase_' + phase_num).slideDown();
	}

	function cancel_edit() {

		$('.delete_warning').hide();
		$('.delete_warning').attr('checked', false);
		$('.deletable').show();

		//$('.edit_phase').hide();
		//$('.view_phase').show();

		$('#view_phase_' + open_phase).slideDown();
		$('#edit_phase_' + open_phase).slideUp();
	}

	function new_phase() {

		cancel_edit();

		$('#add_new_phase').hide();
		$('#new_phase').show();
	}

	function toggle_delete(phase_num, is_one) {

		var checkbox_1 = $('#delete_1_' + phase_num);
		var checkbox_2 = $('#delete_2_' + phase_num);

		if (is_one) {
			checkbox_2.attr('checked', checkbox_1.attr('checked'));

		}
		else {
			checkbox_1.attr('checked', checkbox_2.attr('checked'));
		}

		if (checkbox_1.attr('checked')) {
			$('#edit_phase_' + phase_num + ' .delete_warning').show();
			checkbox_1.parent().hide();
		}
		else {
			$('#edit_phase_' + phase_num + ' .delete_warning').slideUp();
			checkbox_1.parent().show();
		}
	}

{% endblock %}



{% block content %}

	<div id="navbar">

		<a href="/dashboard/"><button id="home_button">Overview</button></a>

		<script>
			$(function() {
				$('#home_button').button("option", { icons: { primary: "ui-icon-home" } });
			});
		</script>
	</div>

	<div id="tab_contents">

		{% for phase in phases %}

			{% include 'dashboard/section_phase_details.html' %}

		{% endfor %}


		<div id="add_new_phase" class="view_phase">
			<a href="javascript:void(0);" onclick="new_phase()">Add another phase</a>
		</div>

		<div id="new_phase" class="edit_phase hidden">

				<h3>New Phase</h3>

				<form action="" method="POST">

					<input type="hidden" name="new_phase" value="true" />

					{{ new_form.as_p }}

					<a href="javascript:void(0);" onclick="cancel_edit();">Cancel new phase</a>
					<input type="submit" value="Save new phase" />

				</form>
		</div>

	</div>

{% endblock %}

